webpackJsonp([12],{"+XQ6":function(t,e){},"5ijU":function(t,e){},"O/zr":function(t,e){},cmRw:function(t,e){},hg1v:function(t,e){},iLqT:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("5Xf9"),i={name:"mail-notic",data:function(){return{checkList:["高危"],mail:{alertEmail_list:[{name:"",icon:!0}],content:"",ssl_switch:!1,host:"",info:"",password:"",port:"",send:!1,user:"",username:""}}},props:{option:{type:Object,default:function(){}}},mounted:function(){this.get_data(),this.check_passwd()},methods:{check_passwd:function(){var t=this;this.$axios.get("/yiiapi/site/check-passwd-reset").then(function(e){var s=e.data,i=s.status,l=s.msg;s.data;if(0!=i)for(var n in l)600==n&&t.$message({message:l[n],type:"warning"}),602==n&&(t.$message({message:l[n],type:"warning"}),a.a.$emit("reset"))})},get_data:function(){var t=this;this.$axios.get("/yiiapi/email/get").then(function(e){var s=e.data,a=s.status,i=s.data;if(console.log(i),t.mail.port=i.port,t.mail.content=i.content,t.mail.host=i.host,t.mail.username=i.username,t.mail.send=i.send,602==a)return!1;"ssl"==i.encryption?t.mail.ssl_switch=!0:t.mail.ssl_switch=!1,0==i.alertEmail.length?(t.mail.alertEmail_list=[],t.mail.alertEmail_list.push({name:"",icon:!0})):(t.mail.alertEmail_list=[],i.alertEmail.forEach(function(e){var s={name:e,icon:!1};t.mail.alertEmail_list.push(s)}),t.mail.alertEmail_list[t.mail.alertEmail_list.length-1].icon=!0)}).catch(function(t){console.log(t)})},handleCheckedCitiesChange:function(t){console.log(t),0==t.length&&this.$message({message:"请至少选择一种威胁等级设置告警邮件通知",type:"warning"})},send_test:function(){var t=this;if(console.log(this.checkList),0==this.checkList.length)return this.$message({message:"请至少选择一种威胁等级设置告警邮件通知",type:"warning"}),!1;var e="",s=[];if(this.mail.alertEmail_list.forEach(function(t){""!=t.name&&s.push(t.name)}),0==s.length)return this.$message({message:"请输入收件箱地址",type:"warning"}),!1;if(""==this.mail.password)return this.$message({message:"请输入邮箱密码",type:"warning"}),!1;e=this.mail.ssl_switch?"ssl":"";var a=[];this.checkList.forEach(function(t){switch(t){case"高危":a.push("high");break;case"中危":a.push("midium");break;case"低危":a.push("low")}}),this.$axios.post("/yiiapi/email/test",{encryption:e,host:this.mail.host,port:this.mail.port,username:this.mail.username,password:this.mail.password,send:this.mail.send,content:this.mail.content,alertEmail:s,degree:a}).then(function(e){var s=e.data,a=s.status,i=s.data;console.log(a),console.log(i),0==a?t.$message({message:"发送测试邮件通知成功",type:"success"}):t.$message({message:e.data.msg,type:"error"})}).catch(function(t){console.log(t)}),console.log(this.mail)},send_save:function(){var t=this;if(0==this.checkList.length)return this.$message({message:"请至少选择一种威胁等级设置告警邮件通知",type:"warning"}),!1;var e="",s=[];if(console.log(this.mail.alertEmail_list),this.mail.alertEmail_list.forEach(function(t){""!=t.name&&s.push(t.name)}),0==s.length)return this.$message({message:"请输入收件箱地址",type:"warning"}),!1;if(""==this.mail.password)return this.$message({message:"请输入邮箱密码",type:"warning"}),!1;e=this.mail.ssl_switch?"ssl":"";var a=[];this.checkList.forEach(function(t){switch(t){case"高危":a.push("high");break;case"中危":a.push("midium");break;case"低危":a.push("low")}}),this.$axios.post("/yiiapi/email/save",{encryption:e,host:this.mail.host,port:this.mail.port,username:this.mail.username,password:this.mail.password,send:this.mail.send,content:this.mail.content,alertEmail:s,degree:a}).then(function(e){var s=e.data,a=s.status,i=s.data;console.log(a),console.log(i),0==a&&(t.get_data(),t.$message({message:"设置邮件通知成功",type:"success"}))}).catch(function(t){console.log(t)})},add_addr:function(){this.mail.alertEmail_list.length<5?(this.mail.alertEmail_list.forEach(function(t){t.icon=!1}),this.mail.alertEmail_list.push({name:"",icon:!0})):this.$message.warning({message:"最多可以设置5个收件邮箱账号。",offset:50})},del_addr:function(t,e){this.mail.alertEmail_list.splice(e,1)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"mail_notic"}},[a("div",{staticClass:"left"},[a("p",{staticClass:"title"},[t._v("邮件服务器设置")]),t._v(" "),a("div",{staticClass:"left_item"},[t._m(0),t._v(" "),a("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入SMTP服务器",clearable:""},model:{value:t.mail.host,callback:function(e){t.$set(t.mail,"host",e)},expression:"mail.host"}})],1),t._v(" "),a("div",{staticClass:"left_item"},[t._m(1),t._v(" "),a("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入SMTP端口",clearable:""},model:{value:t.mail.port,callback:function(e){t.$set(t.mail,"port",e)},expression:"mail.port"}})],1),t._v(" "),a("p",{staticClass:"title"},[t._v("\n      SMTP启用安全连接SSL启用\n      "),a("el-switch",{model:{value:t.mail.ssl_switch,callback:function(e){t.$set(t.mail,"ssl_switch",e)},expression:"mail.ssl_switch"}})],1),t._v(" "),a("div",{staticClass:"left_item"},[t._m(2),t._v(" "),a("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入邮箱地址",clearable:""},model:{value:t.mail.username,callback:function(e){t.$set(t.mail,"username",e)},expression:"mail.username"}})],1),t._v(" "),a("div",{staticClass:"left_item"},[t._m(3),t._v(" "),a("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入邮箱密码","show-password":""},model:{value:t.mail.password,callback:function(e){t.$set(t.mail,"password",e)},expression:"mail.password"}})],1),t._v(" "),a("div",{staticClass:"left_item"},[a("el-button",{staticClass:"save_btn",attrs:{type:"primary"},on:{click:t.send_save}},[t._v("保存")]),t._v(" "),a("el-button",{staticClass:"test_btn",attrs:{type:"primary"},on:{click:t.send_test}},[t._v("发送测试邮件")])],1)]),t._v(" "),a("div",{staticClass:"mid"},[a("p",{staticClass:"title"},[t._v("收件邮箱账号")]),t._v(" "),a("div",{staticClass:"mid_item"},[t._m(4),t._v(" "),t._l(t.mail.alertEmail_list,function(e,i){return a("div",{staticClass:"item_addrs"},[a("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入邮箱地址，最多可以设置5个收件邮箱账号",clearable:""},model:{value:e.name,callback:function(s){t.$set(e,"name",s)},expression:"item.name"}}),t._v(" "),e.icon?a("img",{staticClass:"img_box",attrs:{src:s("uJWp"),alt:""},on:{click:t.add_addr}}):t._e(),t._v(" "),e.icon?t._e():a("img",{staticClass:"img_box",attrs:{src:s("ic23"),alt:""},on:{click:function(s){return t.del_addr(e,i)}}})],1)})],2),t._v(" "),a("div",{staticClass:"mid_item"},[a("p",[t._v("发送内容")]),t._v(" "),a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticClass:"select_box",attrs:{type:"textarea",rows:10,autosize:"",maxlength:"500","show-word-limit":"",resize:"none",placeholder:"请输入发送内容",clearable:""},model:{value:t.mail.content,callback:function(e){t.$set(t.mail,"content",e)},expression:"mail.content"}}),t._v(" "),a("span",{staticStyle:{width:"16px"}})],1)]),t._v(" "),a("p",{staticClass:"title"},[t._v("\n      发生警告时给此邮箱发送通知邮件\n      "),a("el-switch",{model:{value:t.mail.send,callback:function(e){t.$set(t.mail,"send",e)},expression:"mail.send"}})],1),t._v(" "),a("div",{staticClass:"mid_item"},[a("p",[t._v("\n        威胁等级\n      ")]),t._v(" "),a("p",{staticStyle:{"margin-top":"10px"}},[a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[a("el-checkbox",{attrs:{label:"高危"}}),t._v(" "),a("el-checkbox",{attrs:{label:"中危"}}),t._v(" "),a("el-checkbox",{attrs:{label:"低危"}})],1)],1)])]),t._v(" "),a("div",{staticClass:"right"})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("SMTP服务器\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("SMTP端口\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("邮箱地址\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("邮箱密码\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("邮箱地址\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])}]};var n=s("VU/8")(i,l,!1,function(t){s("hg1v"),s("+XQ6")},"data-v-55a08ed4",null).exports,c={name:"mail-notic",data:function(){return{message:{type:"",id:"",key:"",name:"",model:""}}},props:{option:{type:Object,default:function(){}}},mounted:function(){this.check_passwd()},methods:{check_passwd:function(){var t=this;this.$axios.get("/yiiapi/site/check-passwd-reset").then(function(e){var s=e.data,i=s.status,l=s.msg;s.data;if(0!=i)for(var n in l)600==n&&t.$message({message:l[n],type:"warning"}),602==n&&(t.$message({message:l[n],type:"warning"}),a.a.$emit("reset"))})}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"short_message"}},[s("div",{staticClass:"left"},[s("div",{staticClass:"left_item"},[t._m(0),t._v(" "),s("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入短信平台 ",clearable:""},model:{value:t.message.type,callback:function(e){t.$set(t.message,"type",e)},expression:"message.type"}})],1),t._v(" "),s("div",{staticClass:"left_item"},[t._m(1),t._v(" "),s("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入AccessKey ID",clearable:""},model:{value:t.message.id,callback:function(e){t.$set(t.message,"id",e)},expression:"message.id"}})],1),t._v(" "),s("div",{staticClass:"left_item"},[t._m(2),t._v(" "),s("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入AccessKey Secret",clearable:""},model:{value:t.message.key,callback:function(e){t.$set(t.message,"key",e)},expression:"message.key"}})],1),t._v(" "),s("div",{staticClass:"left_item"},[s("p",[t._v("短信签名\n      ")]),t._v(" "),s("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入短信签名",clearable:""},model:{value:t.message.name,callback:function(e){t.$set(t.message,"name",e)},expression:"message.name"}})],1),t._v(" "),s("div",{staticClass:"left_item"},[s("p",[t._v("短信模板")]),t._v(" "),s("el-input",{staticClass:"select_box",attrs:{type:"textarea",rows:10,autosize:"",resize:"none",placeholder:"请输入短信模板",clearable:""},model:{value:t.message.model,callback:function(e){t.$set(t.message,"model",e)},expression:"message.model"}})],1),t._v(" "),s("div",{staticClass:"left_item btn_box"},[s("el-button",{staticClass:"save_btn",attrs:{type:"primary"}},[t._v("保存")]),t._v(" "),s("el-button",{staticClass:"test_btn",attrs:{type:"primary"}},[t._v("发送测试短信")])],1)]),t._v(" "),s("div",{staticClass:"mid"}),t._v(" "),s("div",{staticClass:"right"})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("短信平台\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("AccessKey ID\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("AccessKey Secret\n        "),e("span",{staticClass:"red_necessary"},[this._v("*")])])}]};var o={components:{mailNotic:n,shortMessage:s("VU/8")(c,r,!1,function(t){s("cmRw"),s("5ijU")},"data-v-5a0eee46",null).exports},name:"system_control_electric",data:function(){return{activeName:"first"}},mounted:function(){this.check_passwd()},methods:{check_passwd:function(){var t=this;this.$axios.get("/yiiapi/site/check-passwd-reset").then(function(e){var s=e.data,i=s.status,l=s.msg;s.data;if(0!=i)for(var n in l)600==n&&t.$message({message:l[n],type:"warning"}),602==n&&(t.$message({message:l[n],type:"warning"}),a.a.$emit("reset"))})},handleClick:function(t,e){console.log(t.label)}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"system_control_threat"}},[s("div",{staticClass:"content_box"},[s("div",{staticClass:"network_tab"},[s("el-tabs",{staticClass:"reset_tab",on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"邮件通知",name:"first"}},[s("mail-notic")],1),t._v(" "),s("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"短信通知",name:"second"}},[s("short-message")],1)],1)],1)])])},staticRenderFns:[]};var h=s("VU/8")(o,m,!1,function(t){s("O/zr"),s("vWQw")},"data-v-76f36d0e",null);e.default=h.exports},vWQw:function(t,e){}});